CMAKE_MINIMUM_REQUIRED(VERSION 3.20)
PROJECT(DiagramSmurf)

IF(TARGET DiagramSmurfLib)
	return()
ENDIF()

SET(CMAKE_CXX_STANDARD 20)

OPTION(BRINGAUTO_TESTS "Enable tests" OFF)
OPTION(BRINGAUTO_SAMPLES "Enable build of sample applications" OFF)
OPTION(BRINGAUTO_INSTALL "Enable install feature" OFF)
OPTION(BRINGAUTO_PACKAGE "Enable package creation" OFF)
OPTION(BRINGAUTO_SYSTEM_DEP "Use system dependencies" OFF)

FILE(GLOB_RECURSE source_files "source/*")
ADD_LIBRARY(DiagramSmurfLib SHARED ${source_files})
TARGET_INCLUDE_DIRECTORIES(DiagramSmurfLib PUBLIC "include")

IF (BRINGAUTO_TESTS)
	ENABLE_TESTING()
	ADD_SUBDIRECTORY("test")
ENDIF(BRINGAUTO_TESTS)

IF (BRINGAUTO_SAMPLES)
	ADD_EXECUTABLE(diagramSmurf example/main.cpp)
	TARGET_LINK_LIBRARIES(diagramSmurf PUBLIC DiagramSmurfLib)
ENDIF(BRINGAUTO_SAMPLES)

IF(BRINGAUTO_INSTALL)
	INCLUDE(GNUInstallDirs)
	INSTALL(TARGETS stateGraphLib EXPORT libstateGraphLibTargets
			LIBRARY DESTINATION ${CMAKE_CURRENT_BINARY_DIR}/lib/DiagramSmurfLib
			ARCHIVE DESTINATION ${CMAKE_CURRENT_BINARY_DIR}/lib/DiagramSmurfLib
			RUNTIME DESTINATION ${CMAKE_CURRENT_BINARY_DIR}/bin/DiagramSmurfLib
			INCLUDES DESTINATION ${CMAKE_CURRENT_BINARY_DIR}/include/DiagramSmurfLib
			)
	INSTALL(
			DIRECTORY
			${CMAKE_CURRENT_SOURCE_DIR}/include/
			DESTINATION
			${CMAKE_CURRENT_BINARY_DIR}/lib/DiagramSmurf/include
			COMPONENT
			Devel
	)
ENDIF()
